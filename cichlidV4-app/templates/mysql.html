{% extends "base.html" %}

{% block content %}
  <head>
    <title>TablesPage</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script type="text/javascript" charset="utf8" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script type="text/javascript" charset="utf8" src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="/static/jquery.dataTables.css">
    <link rel="stylesheet" href="/static/buttons.dataTables.css"> <!--https://cdn.datatables.net/buttons/1.5.6/css/buttons.dataTables.min.css">-->

    <script type="text/javascript" charset="utf8" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"> </script>
    <script type="text/javascript" charset="utf8" src="https://code.jquery.com/jquery-3.3.1.js"> </script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"> </script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.colVis.min.js"> </script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/1.5.6/js/dataTables.buttons.min.js"> </script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.html5.min.js"> </script>
    <script type="text/javascript" charset="utf8" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.flash.min.js"></script>
    <script type="text/javascript" charset="utf8" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<style>

	.TFtable{
			border-collapse:collapse;
	}
	.TFtable td, th{
		border:#4e95f4 1px solid;
	}
	/* provide some minimal visual accomodation for IE8 and below */
	.TFtable tr{
		background: #b8d1f3;
	}
  /*  Define the colour for the header row  */
	.TFtable th{
		background: #77A7E8;
	}
	/*  Define the background color for all the ODD background rows  */
	.TFtable tr:odd{
		background: #b8d1f3;
	}
	/*  Define the background color for all the EVEN background rows  */
	.TFtable tr:nth-child(even){
		background: #E4EDFA;
	}

  .alignright {
	float: right;
  margin-right: 10px;
  }
</style>


</head>
    <div>
    <h5 style="text-indent: 50px;"> <b>{{title}}</b> </style>
    <b class="alignright">
    {% for breadcrumb in crumbs %}
        <a href="{{ breadcrumb[0] }}">{{ breadcrumb[1] }}</a>
        {{ '>' if not loop.last }}
    {% endfor %}</b>
  </h5>
    </div>
  </p>
  <p> {{url_param}} </p>
 <body>
   <table class="TFtable" id="TFtable">
     <thead>
       {% for key in results[0] %}
      <th>{{key}}</th>
       {% endfor %}
     </thead>
     <tbody>
     {% for row in results[1] %}
      <tr>{% for data in row %}
          <td>{{data}}</td>
         {% endfor %}
      </tr>
     {% endfor %}
   </tbody>
   </table>
 </body>

   <script>
           var tt = '{{ title }}'.substring(11,);
   $(document).ready(function() {
     $('#TFtable').DataTable( {
       dom: 'Bfrtip',
       'sScrollY': '400px',
       'sScrollX': '100%',
       buttons: [
         {extend: 'colvis', postfixButtons: ['colvisRestore'], text: 'add/remove columns'},
         {extend: 'csvHtml5', text: 'Save current page (TSV)',
             exportOptions: { modifier: {
               fieldSeparator: '\t',
               extension: '.tsv',
               page: 'current'}}},
          {extend: 'excel', text: 'Save current page (excel)',
               exportOptions: { modifier: {
                 fieldSeparator: '\t',
                 page: 'current'}}},
          {extend: 'pdf', text: 'Save current page (pdf)',
                exportOptions: { modifier: {
                  page: 'current'}}}
     ],
       "columnDefs": [ {
        "targets": 0,
        "render": function( data, type, row ) {
            if ('{{url_param[0]}}' != 'nolink') {
              data2 = '<a href="/{{db}}/api/1.0/'+'{{ url_param[0] }}/'+ row[{{ url_param[1] }}]+ '{{ url_param[2] }}">' + data+ '</a>';
            } else {
              data2 = data;
            }
            return data2;
          }
        } ]
   } )
 } );
</script>

 {% endblock %}
